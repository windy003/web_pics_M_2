{% extends "base.html" %}

{% block title %}搜索结果 - 图片收藏网站{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h2>搜索结果</h2>
        {% if query %}
        <p class="text-muted">搜索关键词: "{{ query }}"</p>
        {% endif %}
    </div>
    <div class="col-md-4">
        <form method="GET" action="{{ url_for('search') }}">
            <div class="input-group mb-3">
                <input type="text" class="form-control" name="q" placeholder="搜索图片..." 
                       value="{{ query }}">
                <button class="btn btn-primary" type="submit">
                    <i class="bi bi-search"></i> 搜索
                </button>
            </div>
            <div class="mb-3">
                <select class="form-select" name="folder_id">
                    <option value="">所有文件夹</option>
                    {% for folder in folders %}
                    <option value="{{ folder.id }}" {% if folder.id|string == selected_folder %}selected{% endif %}>
                        {{ folder.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
        </form>
    </div>
</div>

{% if query %}
    {% if images %}
    <div class="row">
        {% for image in images %}
        <div class="col-md-6 col-lg-4 col-xl-3 mb-4">
            <div class="card image-card">
                <img src="{{ url_for('uploaded_file', user_id=session.user_id, folder_id=image.folder_id, filename=image.filename) }}" 
                     class="card-img-top image-thumbnail" alt="{{ image.original_filename }}">
                <div class="card-body">
                    <h6 class="card-title">{{ image.original_filename }}</h6>
                    <small class="text-muted">
                        <i class="bi bi-folder"></i> {{ image.folder_name }}
                    </small><br>
                    <small class="text-muted">{{ image.uploaded_at }}</small>
                    <div class="mt-2">
                        <a href="{{ url_for('view_folder', folder_id=image.folder_id) }}" 
                           class="btn btn-sm btn-outline-primary">
                            <i class="bi bi-folder-open"></i> 查看文件夹
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-5">
        <i class="bi bi-search" style="font-size: 4rem; color: #ccc;"></i>
        <h4 class="mt-3 text-muted">未找到相关图片</h4>
        <p class="text-muted">尝试使用其他关键词搜索</p>
    </div>
    {% endif %}
{% else %}
<div class="text-center py-5">
    <i class="bi bi-search" style="font-size: 4rem; color: #ccc;"></i>
    <h4 class="mt-3 text-muted">输入关键词开始搜索</h4>
    <p class="text-muted">可以搜索图片名称、文件夹名称或文件夹描述信息</p>
</div>
{% endif %}
{% endblock %} 